<h2>Edit <%= resource_name.to_s.humanize %></h2>

<%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put, multipart: true }) do |f| %>
  <%= render "devise/shared/error_messages", resource: resource %>

  <div class="field">
    <%= f.label :icon, "アイコン" %><br />
    <img id="icon_preview" src="<%= resource.icon.url %>" alt="User Icon" width="100" height="100">
    <br>
    <%= f.file_field :icon, id: "icon_input" %>
</div>

  <div class="field">
    <%= f.label :"苗字" %><br />
    <%= f.text_field :last_name, placeholder: "例:田中",class:"border-black" %>
  </div>

  <div class="field">
    <%= f.label :"名前" %><br />
    <%= f.text_field :first_name, placeholder: "例:太郎"%>
  </div>

  <div class="field">
    <%= f.label :"ユーザネーム" %><br />
    <%= f.text_field :nick_name, placeholder: "例:yamada"%>
  </div>

  <div class="field">
    <%= f.label :"電話番号(ハイフンなし)" %><br />
    <%= f.text_field :phone_number, placeholder: 123456789 %>
  </div>

  <div class="field">
    <%= f.label :"メールアドレス" %><br />
    <%= f.email_field :email, autofocus: true, autocomplete: "email", placeholder: "tarou@example.com" %>
  </div>

  <div class="field">
    <%= f.label :パスワード %> <i>(パスワードを変更する場合は新しいパスワードを、そのままの場合は既存のパスワードを入力してください)</i><br />
    <%= f.password_field :password, autocomplete: "new-password" %>
    <% if @minimum_password_length %>
      <br />
      <em><%= @minimum_password_length %> 文字以上</em>
    <% end %>
  </div>

  <div class="field">
    <%= f.label :確認用パスワードを入力してください %><br />
    <%= f.password_field :password_confirmation, autocomplete: "new-password" %>
  </div>

  <div class="field">
    <%= f.label :現在のパスワード %> <i>(パスワードを変更した場合は以前のパスワードを、そのままの場合は既存のパスワードを入力してください)</i><br />
    <%= f.password_field :current_password, autocomplete: "current-password" %>
  </div>

  <div class="field">
    <%= f.label :"郵便番号(ハイフンなし)" %><br />
    <%= f.text_field :postal_code, placeholder: 123456789 %>
  </div>

  <div class="field">
    <%= f.label :"都道府県" %><br />
    <%= f.select :prefecture,
      [ ["北海道"],["青森県"],["岩手県"],["宮城県"],["秋田県"],
        ["山形県"],["福島県"],["茨城県"],["栃木県"],["群馬県"],
        ["埼玉県"],["千葉県"],["東京都"],["神奈川県"],["新潟県"],
        ["富山県"],["石川県"],["福井県"],["山梨県"],["長野県"],
        ["岐阜県"],["静岡県"],["愛知県"],["三重県"],["滋賀県"],
        ["京都府"],["大阪府"],["兵庫県"],["奈良県"],["和歌山県"],
        ["鳥取県"],["島根県"],["岡山県"],["広島県"],["山口県"],
        ["徳島県"],["香川県"],["愛媛県"],["高知県"],["福岡県"],
        ["佐賀県"],["長崎県"],["熊本県"],["大分県"],["宮崎県"],
        ["鹿児島県"],["沖縄県"]
      ], include_blank: "都道府県を選択して下さい"%>
  </div>

  <div class="field">
    <%= f.label :"市区町村" %><br />
    <%= f.text_field :municipality, placeholder: "⚪⚪︎市××区" %>
  </div>

  <div class="field">
    <%= f.label :"以降の住所" %><br />
    <%= f.text_field :street_address, placeholder: "⚪︎丁目⚪︎番地 ××マンション △△号室" %>
  </div>

  <div class="field">
    <%= f.label :"取引可能範囲" %><br />
    <%= f.select :movable_range,
    [["0~50km", 0],["50~100km", 1],["100~200km", 2],["それ以上可能", 3]], include_blank: "移動可能範囲を選択してください"%>
  </div>

  <div class="field">
    <%= f.label :"性別" %><br />
    <%= f.select :sex,
    [["男"],["女"],["その他"]], include_blank: "性別を選択してください"%>
  </div>

  <div class="field">
    <%= f.label :"職業" %><br />
    <%= f.select :occupation,
    [["会社員"],["学生"],["その他"]], include_blank: "職業を選択してください"%>
  </div>

  <div class="field">
    <%= f.label :"自己紹介" %><br />
    <%= f.text_field :self_introduction, placeholder: "よろしくお願いいたします。" %>
  </div>

  <div class="actions">
    <%= f.submit "Update" %>
  </div>
<% end %>

<h3>Cancel my account</h3>

<p>Unhappy? <%= button_to "Cancel my account", registration_path(resource_name), data: { confirm: "Are you sure?" }, method: :delete %></p>

<%= link_to "Back", :back %>

<script>
  $(document).ready(function() {
    $('#icon_input').on('change', function() {
      const file = this.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          $('#icon_preview').attr('src', e.target.result).show();
        };
        reader.readAsDataURL(file);
      } else {
        $('#icon_preview').hide();
      }
    });
  });
</script>